\documentclass[10pt, russian]{book}

\usepackage{lipsum} % DELME

\sloppy
%%% Константы %%%
\newcommand{\Author}{В.~И.~Великодный}
\newcommand{\AuthorI}{Великодный~В.~И.}
\newcommand{\Title}{Программирование}
\newcommand{\SubTitle}{Часть I}
\newcommand{\PubType}{Курс лекций}
\newcommand{\Year}{2012}

\newcommand{\UDC}{???} % УДК
\newcommand{\BBK}{???} % ББК
\newcommand{\AS}{В??}  % Авторский знак

%%% Математические окружения %%%
\usepackage{amsthm}

\theoremstyle{definition}
\newtheorem{defn}{\protect\definitionname}[chapter]
\providecommand{\definitionname}{Определение}

\theoremstyle{definition}
\newtheorem{example}{\protect\examplename}[chapter]
\providecommand{\examplename}{Пример}

%%% Математические шрифты %%%
\usepackage{amssymb}
\usepackage{unicode-math}
%\setmathfont{Asana Math}
%\setmathfont{xits-math.otf}
\setmathfont{texgyrepagella-math.otf}

%%% Шрифты документа %%%
\usepackage{fontspec}					% Использовать OTF/TTF
\defaultfontfeatures{Mapping=tex-text}
\setmainfont{Charis SIL}
\setsansfont{Liberation Sans}
\setmonofont{Liberation Mono}
%\defaultfontfeatures{Scale=MatchLowercase, Mapping=tex-text}

%%% Семейства шрифтов %%%
\newfontfamily\footfont{Droid Sans} 
\newfontfamily\titlefont{Ubuntu} 
\newfontfamily\lstfont{Ubuntu}

%%% Графика %%%
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{positioning,arrows}

%%% Тексты программ %%%
\usepackage{listings}
\lstset{
  basicstyle={\small\lstfont},
  breaklines=true,
  language={[Sharp]C},
  numbers=left,
  numberstyle={\scriptsize},
  showstringspaces=false,
  tabsize=4,
  escapeinside={\%*}{*)}            % if you want to add LaTeX within your code
}

%%% Геометрия страницы %%%
\usepackage[
  twoside,
  driver=xetex,
  a5paper,
  includefoot,
  headsep=0mm,
  tmargin=1.5cm,
  bmargin=1.5cm,
  lmargin=1.5cm,
  rmargin=1.5cm
]{geometry}

%%% Колонтитулы %%%
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\chaptermark}[1]{\markboth{#1}{}} 
\fancyfoot[LE]{\footfont \textbf{\thepage}  |\ Глава \thechapter.  \nouppercase{\leftmark{}}}
\fancyfoot[RO]{\footfont \nouppercase{\rightmark{}}\  |\ \textbf{\thepage}}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0.4pt}
\fancypagestyle{plain}{
  \fancyhf{}
  \fancyfoot[C]{\footfont\textbf{\thepage}}
  \renewcommand{\headrulewidth}{0pt}
  \renewcommand{\footrulewidth}{0.4pt}
}

%%% Настройки PDF %%%
\usepackage[
  unicode=true,
  bookmarks=true,
  bookmarksnumbered=false,
  bookmarksopen=false,
  breaklinks=false,
  pdfborder={0 0 0},
  backref=false,
  colorlinks=false
]{hyperref}
\hypersetup{
  pdftitle={\Title},
  pdfauthor={\Author}
}

%%% Локализация %%%
\usepackage{xunicode}
\usepackage{polyglossia}
\setdefaultlanguage[spelling=modern]{russian}
\setotherlanguage{english}

%%% Прочее %%%
\usepackage{indentfirst}
%\usepackage[russian]{varioref}
\usepackage{mathtext}
\usepackage[normalem]{ulem} % ???
\usepackage{stmaryrd} % ???
\usepackage{index}
\usepackage{calc}
\usepackage{fancyvrb}
\usepackage{rotating}

%%% Индекс %%%
\makeindex
